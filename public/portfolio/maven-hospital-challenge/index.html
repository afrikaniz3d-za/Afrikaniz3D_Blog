<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4321&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Afrikaniz3D Blogfolio</title>
<meta name="description" content="Combination of a blog and portfolio I use to try host as much of my works in one place.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://localhost:4321/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="http://localhost:4321/css/font-awesome.min.css">
<link rel="stylesheet" href="http://localhost:4321/css/owl.carousel.css">
<link rel="stylesheet" href="http://localhost:4321/css/owl.theme.css">


  <link href="http://localhost:4321/css/style.graylime.css" rel="stylesheet" id="theme-stylesheet">

 

  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  


<link href="http://localhost:4321/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="http://localhost:4321/img/favicon.png">


  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-068HZ9Y7CD"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-068HZ9Y7CD');
        }
      </script>
    
  



</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              <div id="sidebar" class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
  <div class="sidebar-content">
    <h1 class="sidebar-heading"><a href="http://localhost:4321/">Afrikaniz3D Blogfolio</a></h1>
    
      <p class="sidebar-p">I am a CG hobbyist working mostly with Blender3D.  Also exploring work in Data Science and Analytics. Yes, A.I. is taking over these fields, but learning and working in them is helping me think goode- better..</p>
    
      <p class="sidebar-p">From and currently based in South Africa.</p>
    
      <p class="sidebar-p">#b3d #hexesminipack #webdevelopment #dataanalytics #datascience #r #powerbi #sql #youtubeseo</p>
    
    <ul class="sidebar-menu">
      
        <li><a href="http://localhost:4321/post/">Blogs</a></li>
      
        <li><a href="http://localhost:4321/portfolio/">Portfolio</a></li>
      
        <li><a href="http://localhost:4321/about/">About Afrikaniz3D</a></li>
      
        <li><a href="http://localhost:4321/contact/">Get in touch</a></li>
      
    </ul>
    <p class="social">
  
  <a href="https://www.facebook.com/Afrikaniz3D-103985428323283" data-animate-hover="pulse" class="external facebook" title="Facebook" rel="me">
    <i class="fa fa-facebook"></i>
  </a>
  
  
  
  <a href="https://twitter.com/afrikaniz3d" data-animate-hover="pulse" class="external twitter" title="Twitter" rel="me">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  <a href="https://www.instagram.com/afrikaniz3d/" title="" class="external instagram" title="Instagram" rel="me">
    <i class="fa fa-instagram"></i>
  </a>
  
  
  <a href="mailto:afrikaniz3d@gmail.com" data-animate-hover="pulse" class="email" title="E-mail">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://www.linkedin.com/in/ntobeko-s-040309203" data-animate-hover="pulse" class="external" title="LinkedIn" rel="me">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="https://github.com/afrikaniz3d-za" data-animate-hover="pulse" class="external" title="GitHub" rel="me">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  <a href="https://youtube.com/c/AFRIKANIZ3D/" data-animate-hover="pulse" class="external" title="YouTube" rel="me">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  <a href="https://wa.me/message/USN7BDK3XJC4K1" data-animate-hover="pulse" class="external" title="WhatsApp">
    <i class="fa fa-whatsapp"></i>
  </a>
  
</p>


    <div class="copyright">
      <p class="credit">
        
          &copy; 2023 Afrikaniz3D / Ntobeko Sosibo |
        
        Template by <a href="https://bootstrapious.com/free-templates" class="external">Bootstrapious.com</a>

&amp; ported to Hugo by <a href="https://github.com/kishaningithub">Kishan B</a>

      </p>
    </div>
  </div>
</div>

              
<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background">
  <div class="small-navbar visible-xs">
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost pull-left"> <i class="fa fa-align-left"> </i>Menu</button>
  <h1 class="small-navbar-heading"><a href="http://localhost:4321/">Afrikaniz3D Blogfolio</a></h1>
</div>

  <div class="row">
    <div class="col-lg-8">
      <div class="content-column-content">
         <h1>Maven Hospital Challenge</h1>
         


<div id="maven-hospital-challenge-introduction" class="section level2">
<h2>1. Maven Hospital Challenge Introduction</h2>
<div id="challenge-objective" class="section level4">
<h4>1.1 Challenge Objective</h4>
<p>For the <a href="https://mavenanalytics.io/challenges/maven-hospital-challenge/facee4d2-8369-4c87-a55e-e6c7ed2a42d8?utm_source=linkedin&amp;utm_campaign=mavenhospitalchallenge_li_maven">Maven Hospital Challenge</a>, you’ll play the role of an Analytics Consultant for <strong>Massachusetts General Hospital (MGH)</strong>.</p>
<p>You’ve been asked to <strong>build a high-level KPI</strong> report for the executive team, based on a subset of patient records. The purpose of the report is to <strong>give stakeholders visibility into the hospital’s recent performance</strong>, and answer the following questions:</p>
<ul>
<li>How many patients have been admitted or readmitted over time?</li>
<li>How long are patients staying in the hospital, on average?</li>
<li>How much is the average cost per visit?</li>
<li>How many procedures are covered by insurance?</li>
</ul>
<p>The dashboard should scale to accommodate new data over time, but the CEO has asked you to summarize any insights you can derive from the sample provided.</p>
</div>
<div id="tools-used" class="section level4">
<h4>1.2 Tools Used</h4>
<p>The data exploration is conducted using <a href="https://www.databricks.com/">Databricks SQL</a>. The data processing, exploration, and results/visualizations are generated and presented in-house. Any stylised images were made using <a href="https://www.gimp.org/">GIMP</a></p>
<p>_</p>
</div>
</div>
<div id="mounting-tables-into-notebook" class="section level2">
<h2>2. Mounting Tables Into Notebook</h2>
<p><img src="/img/portfolio/W14/w14001.png" /></p>
<p><img src="/img/portfolio/W14/w14002.png" /></p>
<p><img src="/img/portfolio/W14/w14003.png" /></p>
<p><img src="/img/portfolio/W14/w14004.png" /></p>
<p><img src="/img/portfolio/W14/w14005.png" /></p>
<p><img src="/img/portfolio/W14/w14006.png" /></p>
<p>_</p>
</div>
<div id="data-profiling-and-cleaning" class="section level2">
<h2>3. Data Profiling and Cleaning</h2>
<div id="profiling-the-patients-table" class="section level4">
<h4>3.1 Profiling the patients table</h4>
<div id="composition" class="section level5">
<h5>3.1.1 Composition</h5>
<p>The <em>patients</em> table is comprised of 20 columns/variables. One (1) variable, <em>ZIP</em> is an <strong>INTERGER</strong>. Two (2) variables (<em>LAT</em> and <em>LON</em>) are <strong>DOUBLE PRECISION</strong> for location data. Another two (2), <em>BIRTHDATE</em> and <em>DEATHDATE</em>, are <strong>DATETIME</strong>, and the remaining fifteen (15) (<em>Id</em>, <em>PREFIX</em>, <em>FIRST</em>, <em>LAST</em>, <em>SUFFIX</em>, <em>MAIDEN</em>, <em>MARITAL</em>, <em>RACE</em>, <em>ETHNICITY</em>, <em>GENDER</em>, <em>BIRTHPLACE</em>, <em>ADDRESS</em>, <em>CITY</em>, <em>STATE</em>, and <em>COUNTY</em>) are <strong>STRING</strong>.</p>
</div>
<div id="categories-within-the-string-data" class="section level5">
<h5>3.1.2 Categories within the STRING data</h5>
<ul>
<li><strong>PREFIX</strong>: Mr., Ms., Mrs<br />
</li>
<li><strong>FIRST</strong>: various first names with an additional random three (3) numbers attached to accommodate instances of people having the same first name (Example: Timothy786)</li>
<li><strong>LAST</strong>: various last names with an additional random three (3) numbers attached to accommodate instances of people having the same last name (Example: Jones034)<br />
</li>
<li><strong>SUFFIX</strong>: JD, PhD, MD<br />
</li>
<li><strong>MAIDEN</strong>: Only used cases where the female patient is married (‘Mrs.’)<br />
</li>
<li><strong>MARITAL</strong>: S (single), M (married)<br />
</li>
<li><strong>RACE</strong>: asian, other, white, black, native, hawaiinan</li>
<li><strong>ETHNICITY</strong>: hispanic, nonhispanic<br />
</li>
<li><strong>GENDER</strong>: F, M<br />
</li>
<li><strong>BIRTHPLACE</strong>: various geographic locations (297 in total)<br />
</li>
<li><strong>CITY</strong>: various cities (29 in total)<br />
</li>
<li><strong>COUNTY</strong>: various counties (5 in total)</li>
</ul>
<p>Things that stood out when looking at this data were namely the <em>ETHNICITY</em> column’s hispanic/nonhispanic binary - which I’ll keep in-mind for the remainder of the exploration - as well as some of the patients from other countries.<br />
The solution for addressing repeated/same names (attaching a random 3-digit number) is worth noting for future projects.</p>
</div>
</div>
<div id="profiling-the-payers-table" class="section level4">
<h4>3.2 Profiling the payers table</h4>
<div id="composition-1" class="section level5">
<h5>3.2.1 Composition</h5>
<p>The <em>payers</em> table is comprised of 7 columns/variables. One (1) variable, <em>ZIP</em> is the only <strong>INTERGER</strong>. The remaining 6 variables (<em>Id</em>, <em>NAME</em>, *ADDRESS<strong>, <em>CITY</em>, <em>STATE_HEADQUARTERED</em>, and <em>PHONE</em>) are </strong>STRING**.</p>
</div>
<div id="categories-within-the-string-data-1" class="section level5">
<h5>3.2.2 Categories within the STRING data</h5>
<ul>
<li><strong>ZIP</strong>: 6002, 46204, 40018, 6156, 55436, 60007, 21244</li>
<li><strong>NAME</strong>: Cigna Health, NO_INSURANCE, Humana, Aetna, Blue Cross Blue Shield, Dual Eligible, Medicaid,
Medicare, UnitedHealthcare, Anthem</li>
<li><strong>CITY</strong>: Louisville, Indianapolis, null, Chicago, Minnetonka, Bloomfield, Hartford, Baltimore<br />
</li>
<li><strong>STATE_HEADQUARTERED</strong>: MN, null, KY, CT, MD, IL, IN</li>
</ul>
<p>Something that stood out which I might explore further are any possible relationships around patients/procedures with <strong>Dual Eligible</strong> as their insurer.</p>
</div>
</div>
<div id="profiling-the-encounters-table" class="section level4">
<h4>3.3 Profiling the encounters table</h4>
<div id="composition-2" class="section level5">
<h5>3.3.1 Composition</h5>
<p>The <em>encounters</em> table is comprised of 14 columns/variables. One (1) variable, <em>REASONCODE</em> is the only <strong>BIGINT</strong>. Three (3) variables (<em>BASE_ENCOUNTER_COST</em>, <em>TOTAL_CLAIM_COST</em>, and <em>PAYER_COVERAGE</em>) are <em>DOUBLE PRECISION</em>. There is another single variable (<strong>CODE</strong>) that is an <strong>INTERGER</strong>, and two (2) variables (<em>START</em> and <em>STOP</em>) that are <strong>TIMESTAMP</strong>. The remaining seven (7) variables (<em>Id</em>, <em>PATIENT</em>, <em>ORGANIZATION</em>, <em>PAYER</em>, <em>ENCOUNTERCLASS</em>, <em>DESCRIPTION</em>, and <em>REASONDESCRIPTION</em>) are all <strong>STRING</strong>.</p>
</div>
<div id="categories-within-the-string-data-2" class="section level5">
<h5>3.3.2 Categories within the STRING data</h5>
<ul>
<li><strong>ENCOUNTERCLASS</strong>: wellness, outpatient, emergency, inpatient. urgentcare, ambulatory<br />
</li>
<li><strong>CODE</strong>: Forty-five (45) numerical strings that are between 7 and 9 digits in length<br />
</li>
<li><strong>DESCRIPTION</strong>: Fifty-three (53) descriptions for the types of encounters. Examples include “<em>Postnatal visit</em>” and “<em>Cardiac Arrest</em>”<br />
</li>
<li><strong>REASONCODE</strong>: Seventy-four (74) numerical strings of varying length (drastic in some cases)<br />
</li>
<li><strong>REASONDESCRIPTION</strong>: Full-text description, corresponding with <em>REASONCODE</em></li>
</ul>
<p>Some of the descriptions are vague, like “<em>Encounter for problem</em>”, and rely on the <em>REASONDESCRIPTION</em> to give more clarity. The distribution of the types of procedures will be explored later on to see what MGH’s “popular” procedures are.</p>
</div>
</div>
<div id="profiling-the-procedures-table" class="section level4">
<h4>3.4 Profiling the procedures table</h4>
<div id="composition-3" class="section level5">
<h5>3.4.1 Composition</h5>
<p>The <em>encounters</em> table is comprised of 9 columns/variables. The first twp (2) variables (<em>START</em> and <em>STOP</em>) are <strong>TIMESTAMP</strong>. Two (2) variables (<em>CODE</em> and <em>REASONCODE</em>) are <strong>BIGINT</strong>. <em>BASE_COST</em> is the only <strong>INTERGER</strong>, and the remaining four (4) variables (<em>PATIENT</em>, <em>ENCOUNTER</em>, <em>DESCRIPTION</em>, and <em>REASONDESCRIPTION</em>) are all <strong>STRING</strong>.</p>
</div>
<div id="categories-within-the-string-data-3" class="section level5">
<h5>3.4.2 Categories within the STRING data</h5>
<ul>
<li><strong>CODE</strong>: 157 numerical string data in ranging digit length that represent procedures<br />
</li>
<li><strong>DESCRIPTION</strong>: 163 text string data describing the procedures performed<br />
</li>
<li><strong>REASONCODE</strong>: Forty-seven (47) numerical strings of various length<br />
</li>
<li><strong>REASONDESCRIPTION</strong>: Forty-seven (47) text string data describing the reasons for the prerformed procedures</li>
</ul>
<p>The thing that stood out for me here was the inclusion of a <em>null</em> value in the <strong>REASONDESCRIPTION</strong> column I’ll look further into to see if the cause can be identified, and whether anything could be done to address it.</p>
<p>_</p>
</div>
</div>
</div>
<div id="answering-the-questions" class="section level2">
<h2>4. Answering the Questions</h2>
<div id="how-many-patients-have-been-admitted-or-readmitted-over-time" class="section level4">
<h4>4.1 How many patients have been admitted or readmitted over time?</h4>
<div id="how-many-patients-have-been-admitted" class="section level5">
<h5>4.1.1 How many patients have been admitted?</h5>
<p>There were <strong>1880</strong> patients admitted. To answer this I needed to first look at an understand what constituted being admitted to the hospital - rather than a visit. some online queries revealed that you could be admitted for as little a time as two (2) hours, and some procedures, regardless of how long, could be done without needing to be admitted.</p>
<p>For this reason, I chose to only look for patients that had the variations of the word “admitted/admission” used in the <em>DESCRIPTION</em> column in the <em>encounters</em> table, or those that had an <em>ENCOUNTER_CLASS</em> of “<em>inpatient</em>” as these two conditions either explicitly state there is admission or admission is the condition for the class designation.</p>
<p><img src="/img/portfolio/W14/w14007.png" /></p>
</div>
<div id="how-many-patients-have-been-readmitted" class="section level5">
<h5>4.1.2 How many patients have been readmitted?</h5>
<p>There are <strong>247</strong> patients that have been readmitted. To answer this question took the query from <strong>4.1.1</strong> and applied an additional conditioned that filtered for <em>COUNT()</em> of the <em>patient</em> column with a value greater than one (1). To account for the initial admission I included a <em>“- 1”</em> to the <em>COUNT()</em> for admissions - so that it’s <strong>only</strong> counting readmissions.</p>
<p><img src="/img/portfolio/W14/w14008.png" /></p>
<p><img src="/img/portfolio/W14/w14009.png" /></p>
</div>
</div>
<div id="how-long-are-patients-staying-in-the-hospital-on-average" class="section level4">
<h4>4.2 How long are patients staying in the hospital, on average?</h4>
<p>Patients are staying <strong>22hrs 52min</strong> on average.</p>
<p><img src="/img/portfolio/W14/w14010.png" /></p>
</div>
<div id="how-much-is-the-average-cost-per-visit" class="section level4">
<h4>4.3 How much is the average cost per visit?</h4>
<p>The average cost of a visit was <strong>$116.18</strong> (base), and <strong>$3 639.68</strong> (with a claim). The <em>encounters</em> table was used to answer this question where I looked at both the <strong>base</strong> cost as well as the <strong>total claim cost</strong> as the question was a little open-ended in that regard.</p>
<p><img src="/img/portfolio/W14/w14011.png" /></p>
</div>
<div id="how-many-procedures-are-covered-by-insurance" class="section level4">
<h4>4.4 How many procedures are covered by insurance?</h4>
<p>Of the <strong>47 701</strong> recorded procedures from <em>2011-01-02</em> to <em>2022-01-29</em>, <strong>8228</strong> (<strong>17.24%</strong>) procedures were covered by insurance.</p>
<div id="querying-the-number-of-procedures-covered-by-insurance" class="section level5">
<h5>4.4.1 Querying the number of procedures covered by insurance</h5>
<p><img src="/img/portfolio/W14/w14012.png" /></p>
</div>
<div id="percentage-of-the-total-procedures-performed-that-were-insured" class="section level5">
<h5>4.4.2 Percentage of the total procedures performed that were insured</h5>
<p><img src="/img/portfolio/W14/w14013.png" /></p>
</div>
<div id="minute-childbirths" class="section level5">
<h5>4.4.3 15-minute childbirths?</h5>
<p>While looking through the <strong>procedures</strong> table I noticed that, particularly among childbirths, there were patients that had multiple 15 minute childbirths and they were happening at seemingly scheduled time slots (like 15:00 or 14:45). A Chat-GPT inquiry revealed that there were a number of possible reasons for this, the most like being <a href="https://www.k2view.com/what-is-data-anonymization/#:~:text=Data%20anonymization%20is%20the%20process%20of%20obscuring%20or%20removing%20personally,people%20associated%20with%20that%20data.">Data Anonymization or Privacy Measures</a>. Learning this made me realise that any deep look into the pregnancy and childbirth data would be skewed by this.</p>
<p>I looked at the other procedure descriptions and found that the same measures weren’t being used. Curious which kinds of procedures the hospital felt needed that level of protection. Of the 163 different types of procedures MGH performs, <strong>93</strong> seem to have varying degrees of anonymization applied.</p>
<p><img src="/img/portfolio/W14/w14014.png" /></p>
<p>After reading many of the descriptions in the results, it makes sense why anonymization was used. The new curiosity was that there were subsets which I could possibly explain as the hospital perhaps having a coding system that classes the procedure by the time length within that category.</p>
<p><img src="/img/portfolio/W14/w14015.png" /></p>
<p>_</p>
</div>
</div>
</div>
<div id="final-thoughts" class="section level2">
<h2>5. Final Thoughts</h2>
<p>This has been a great exercise in getting a lot of practice with <strong>CTE</strong>. Some queries more than three (3) CTEs with <em>JOIN</em>s included. I also had previously never encountered cases where I had a <em>FROM</em> statement that referenced two tables, so I’m looking forward to getting more practice there.<br />
It was also interesting working with hospital data, getting to learn about people’s live throught their relationships with the hospital. Some of their patients have been through so much..</p>
</div>

         <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "afrikaniz3d" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
    </div>
  </div>
</div>

          </div>
      </div>
  </div>
  <script src="http://localhost:4321/js/jquery.min.js"></script>
<script src="http://localhost:4321/js/bootstrap.min.js"></script>
<script src="http://localhost:4321/js/jquery.cookie.js"> </script>
<script src="http://localhost:4321/js/ekko-lightbox.js"></script>
<script src="http://localhost:4321/js/jquery.scrollTo.min.js"></script>
<script src="http://localhost:4321/js/masonry.pkgd.min.js"></script>
<script src="http://localhost:4321/js/imagesloaded.pkgd.min.js"></script>
<script src="http://localhost:4321/js/owl.carousel.min.js"></script>
<script src="http://localhost:4321/js/front.js"></script>



</body>
</html>
